## –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µüõ°Ô∏è Backend API ‚Äî NestJS + PostgreSQL + JWT

> ‚ÑπÔ∏è –ü–æ–ª–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ñ–∞–π–ª–µ  
> **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ.pdf**

**–¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ** "Backend API –±–ª–æ–≥–∞" –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ—Ñ–∏–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –µ–≥–æ –ø–æ—Å—Ç–∞–º–∏, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ NestJS —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PostgreSQL –∏ TypeORM.  
–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç:
- Rest api Auth, Posts, Users
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ JWT (access + refresh)
- Fingerprint-–∑–∞—â–∏—Ç—É refresh-—Ç–æ–∫–µ–Ω–æ–≤
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
- –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î Postgres
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å—Ö–µ–º–∞–º–∏ zod
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –∏–∑–±–æ—Ä–∞–∂–µ–Ω–∏–π –ø–æ File Magic Numbers
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ Docker Compose

### üåê –°–≤—è–∑–∞–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
–§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è —ç—Ç–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ:  
üëâ [https://github.com/ziaq/test-task-blog-react-shadcn](https://github.com/ziaq/test-task-blog-react-shadcn)

---

### üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **NestJS** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π backend-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **TypeORM** ‚Äî ORM
- **JWT** ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Multer** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Zod** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Docker / Docker Compose** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

## üîß –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª API

### üõ°Ô∏è –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /auth/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
  –¢—Ä–µ–±—É–µ—Ç—Å—è –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ JSON-–æ–º:  
  –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - `email` ‚Äî email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
  - `password` ‚Äî –ø–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)  
  - `firstName` ‚Äî –∏–º—è  
  - `lastName` ‚Äî —Ñ–∞–º–∏–ª–∏—è  

  –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - `phone` ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞  
  - `birthDate` ‚Äî –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD`  
  - `about` ‚Äî –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–±–µ

- `POST /auth/login` ‚Äî –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `accessToken` –∏ —É—Å—Ç–∞–Ω–∞–ª–∏–≤–∞–µ—Ç `refreshToken` –≤ cookie  
–¢—Ä–µ–±—É–µ—Ç—Å—è –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ JSON-–æ–º:
  - `email` ‚Äî email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
  - `password` ‚Äî –ø–∞—Ä–æ–ª—å  
  - `fingerprint` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ 

- `POST /auth/logout` ‚Äî –≤—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —É–¥–∞–ª—è–µ—Ç refreshToken –∏–∑ –±–∞–∑—ã –∏ –æ—á–∏—â–∞–µ—Ç cookie  
    –¢—Ä–µ–±—É–µ—Ç—Å—è:
  - –ù–µ –∏—Å—Ç–µ–∫—à–∏–π `refreshToken` –≤ cookie  
  - Fingerprint –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ JSON-–æ–º

- `POST /auth/refresh` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π `accessToken`  
   	–¢—Ä–µ–±—É–µ—Ç—Å—è:
  - –ù–µ –∏—Å—Ç–µ–∫—à–∏–π `refreshToken` –≤ cookie  
  - Fingerprint –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ JSON-–æ–º

### üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º
> üîê –í–µ–∑–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (`accessToken` –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization: `Bearer ...`)
- `GET /profile` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PATCH /profile` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è  
  –¢—Ä–µ–±—É–µ—Ç—Å—è –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ JSON-–æ–º:  
  –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - `email` ‚Äî email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
  - `password` ‚Äî –ø–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)  
  - `firstName` ‚Äî –∏–º—è  
  - `lastName` ‚Äî —Ñ–∞–º–∏–ª–∏—è  

  –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - `phone` ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞  
  - `birthDate` ‚Äî –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD`  
  - `about` ‚Äî –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–±–µ
- `POST /profile/avatar` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
  –¢—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `multipart/form-data` —Å —Ñ–∞–π–ª–æ–º –≤ –ø–æ–ª–µ —Å –∏–º–µ–Ω–µ–º `file`  
  –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: `jpg`, `jpeg`, `png`  
  –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 5MB

### üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–º–∏
> üîê –í–µ–∑–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (`accessToken` –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization: `Bearer ...`)
- `GET /posts` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Å—Ç–æ–≤ —é–∑–µ—Ä–∞
  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:
  - `limit` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
  - `offset` ‚Äî —Å–º–µ—â–µ–Ω–∏–µ
  - `sort` ‚Äî —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (`asc` / `desc`)

- `POST /posts` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞  
  –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞–∫ `multipart/form-data`.

  –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - `text` ‚Äî —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ (–º–∞–∫—Å–∏–º—É–º 10‚ÄØ000 —Å–∏–º–≤–æ–ª–æ–≤)

  –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - –¥–æ 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º—ã—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª—è—Ö —Å –∏–º–º–µ–Ω–µ–º `file`  
  –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: `jpg`, `jpeg`, `png`  
  –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 5MB

- `PATCH /posts/:id` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ—Å—Ç–∞  
  –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `id` –≤ URL.  
  –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞–∫ `multipart/form-data`.

  –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - `text` ‚Äî –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ (–º–∞–∫—Å–∏–º—É–º 10‚ÄØ000 —Å–∏–º–≤–æ–ª–æ–≤)

  –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  	- –ü–æ–ª–µ `deleteImageIds` ‚Äî –º–∞—Å—Å–∏–≤ `id` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å.  
  	–ü—Ä–∏–º–µ—Ä: `deleteImageIds: [23, 56, 79]`  
    - –¥–æ 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º—ã—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª—è—Ö —Å –∏–º–µ–Ω–µ–º `file`  
    –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: `jpg`, `jpeg`, `png`  
    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 5MB

- `DELETE /posts/:id` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞  
  –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `id` –≤ URL.


---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/your-org/nest-auth-api.git
cd nest-auth-api
```
### 2. –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π —Ñ–∞–π–ª .env —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:
```env
NODE_ENV=development
SERVER_IP=0.0.0.0
SERVER_PORT=3001
CLIENT_IP=localhost
CLIENT_PORT=5171

POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USERNAME=postgres
POSTGRES_PASSWORD=123456
POSTGRES_DB=postgres

JWT_ACCESS_SECRET=secret_access_token_key_123!@#
JWT_REFRESH_SECRET=even_more_secret_refresh_token_key_456!@#
```
### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ docker-compose
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–µ—Ä–µ–π–¥–∏ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏ –∫–æ–º–∞–Ω–¥—ã:
1. –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
```bash
docker-compose build
```
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
```bash
docker-compose up -d
```

–≠—Ç–æ –ø–æ–¥–Ω–∏–º–µ—Ç:

- ‚úÖ **API-—Å–µ—Ä–≤–µ—Ä NestJS** ‚Äî –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: [`http://localhost:3001`](http://localhost:3001)
- ‚úÖ **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:  
  `localhost:5432`  
‚ÑπÔ∏è –õ–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å, –∏–º—è –±–∞–∑—ã, –∞ —Ç–∞–∫–∂–µ –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ—Ä—É—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ `.env`